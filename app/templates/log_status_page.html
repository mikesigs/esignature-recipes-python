<!-- extend base layout -->
{% extends "base.html" %}

{% block content %}
    <div class="api_logs" xmlns="http://www.w3.org/1999/html"></div>
    <h1>API Logs</h1>
    <p><form><p>The DocuSign platform stores up to 50 log entries at a time. Download the log entries to enable more logging.
    The platform logs all API calls for your account, including those from other clients. To only see your appâ€™s
    calls, add an <i>X-ray</i> header to your calls.
    <input type="checkbox" id="only-x-ray-check" class="inline-checkbox" checked>Only show X-ray calls</input>
    <input type="checkbox" id="omit-content" class="inline-checkbox" checked>Omit base64 content</input>
    </form></p>
    <p id="status">Platform logging status: <span id="logging-status">tbd</span><span></span></span><a href="#" id="logging-status-refresh" class="marginleft">Refesh</a>
        <button type="button" class="btn btn-primary marginleft" id="logging-download" data-feedback="feedback-download">Download Logs</button>
        <span id="feedback-download"></span><span></span>
    </p>
    <p></p>

    <div class="row fill">
    	<div class="wrapper">
      	  <div id="status_left" class="col-md-3">
    		  <p id="working">Working</p>
    		  <ul id="toc" class="list-unstyled"></ul>
    		  <ul class="margintop"><li>Click on an entry to view it</li></ul>
    	  </div>
      	  <div id="right_column" class="col-md-9">
    		  <div id="xml_info">
    		  </div>
    		  <div id="editor"></div>
    		  <p class="margintop">&nbsp;</p>
    	  </div>
    	<div>
    </div>

    {% raw %}
    <!-- Mustache template for toc entries -->
    <!-- See https://github.com/janl/mustache.js -->
    <!--//    success: boolean -- was the call successful?
        //    url: the url for retrieving the call
        //    file_name: the raw file_name. Can be used for sorting the entries
        //    x_ray: false if no x_ray header. Otherwise the contents of the header
        //    method: GET, POST, etc
        //    request_url: the complete request url
        //    method_name: the method name used in the log file name
        //    head: the NOT uuencoded first 1500 bytes of the log entry
        //    date_time: the call was made before this time
    -->
    <script id="toc_item_template" type="x-tmpl-mustache">
    <li class="toc_item" data-toggle="tooltip" data-placement="right" title="Request {{ request_url }}">
    	<h4><div class="sm-circle {{css_class}}"></div><span class="http-method">{{method}}</span> {{ method_name }}</h4>
    	{{#recipients}}
    		<p>{{type}}: {{user_name}}<br/>
    			<span class="{{status_class}}">Status: {{status}}</span>
    		</p>
    	{{/recipients}}
    </li>
    </script>

    <!-- Mustache template for displaying the log entry -->
    <!-- XML in Ace editor, see http://stackoverflow.com/a/16147926/64904 -->
    <script id="xml_file_template" type="x-tmpl-mustache">
    	<h3>XML Notification Content</h3>
    	<h5 class="{{envelope_status_class}}">Envelope status: {{envelope_status}}</h5>
    	<p class="margintop">Recipients</p>
    	<ul>
    	{{#recipients}}
    		<li>{{type}}: {{user_name}} <span class="{{status_class}}">Status: {{status}}</span></li>
    	{{/recipients}}
    	</ul>
    	<h5><a href='{{xml_url}}' target='_blank'>Download the XML file</a></h5>
    	{{#documents.length}}
    		<p>Documents<ul>
    			{{#documents}}
    				<li>Document ID {{document_ID}}: {{name}} <a href='{{url}}' target='_blank'>Download</a></li>
    			{{/documents}}
    		</ul></p>
    	{{/documents.length}}
    </script>
    {% endraw %}
    
{% endblock %}
